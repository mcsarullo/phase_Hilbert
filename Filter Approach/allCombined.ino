#include "KickFilters.h"
  
double coef[] = {-0.0000,   -0.0029,   -0.0000,   -0.0049,   -0.0000,   -0.0091,   -0.0000,   -0.0162,   -0.0000,   -0.0271,   -0.0000,   -0.0433,   -0.0000,   -0.0681,   -0.0000,   -0.1102,   -0.0000,   -0.2016,   -0.0000,   -0.6330,         0,    0.6330,    0.0000,    0.2016,    0.0000,    0.1102,    0.0000,    0.0681,    0.0000,    0.0433,    0.0000,    0.0271,    0.0000,    0.0162,    0.0000,    0.0091,    0.0000,    0.0049,    0.0000,    0.0029,    0.0000};
int coefLen = 41; 

const uint16_t samples = 200;
float filtered[samples] = {0};
float tmpArr[samples] = {0};

//sine wave of 5 Hz + 30 Hz + 1.5 Hz (HA)
const float input[] = {0,    2.4901,    2.8324,    2.3966,    3.6591,    5.9359,    6.4641,    5.0107,    4.2362,    5.2014,    5.5973,    3.6850,    1.2939,    0.8185,    1.2739,    0.0611,   -2.5426,   -3.7500,   -2.8740,   -2.4095,   -3.7654,   -4.8511,   -3.5915,   -1.4402,   -0.9641,   -1.5713,   -0.5877,    2.1392,    3.8811,    3.5262,    3.3513,    5.0847,    6.9072,    6.4565,    4.7684,    4.5094,    5.4824,    4.9888,    2.4336,    0.4019,    0.3863,    0.3687,   -1.6688,   -4.2336,   -4.7406,   -3.7846,   -4.0643,   -5.7767,   -6.2550,   -4.4633,   -2.7639,   -2.9757,   -3.3702,   -1.6705,    1.0119,    1.9488,    1.2930,    1.7189,    3.8186,    5.0256,    3.8862,    2.4762,    2.8862,    3.7075,    2.4458,   -0.2118,   -1.4777,   -1.0745,   -1.6007,   -4.0411,   -6.0010,   -5.6506,   -4.7287,   -5.5439,   -7.0355,   -6.5426,   -4.2980,   -3.0646,   -3.5261,   -3.2062,   -0.7347,    1.7404,    2.0713,    1.6281,    2.8869,    5.1640,    5.6962,    4.2507,    3.4880,    4.4686,    4.8836,    2.9939,    0.6289,    0.1830,    0.6709,   -0.5062,   -3.0715,   -4.2377,   -3.3182,   -2.8080,   -4.1161,   -5.1524,   -3.8417,   -1.6382,   -1.1088,   -1.6621,   -0.6241,    2.1574,    3.9538,    3.6531,    3.5317,    5.3176,    7.1916,    6.7909,    5.1512,    4.9386,    5.9559,    5.5043,    2.9884,    0.9933,    1.0113,    1.0242,   -0.9860,   -3.5270,   -4.0137,   -3.0411,   -3.3078,   -5.0110,   -5.4839,   -3.6907,   -1.9937,   -2.2117,   -2.6163,   -0.9303,    1.7346,    2.6504,    1.9700,    2.3679,    4.4364,    5.6091,    4.4325,    2.9825,    3.3500,    4.1266,    2.8180,    0.1116,   -1.2046,   -0.8531,   -1.4322,   -3.9262,   -5.9404,   -5.6445,   -4.7772,   -5.6468,   -7.1922,   -6.7523,   -4.5597,   -3.3770,   -3.8876,   -3.6150,   -1.1888,    1.2433,    1.5337,    1.0526,    2.2765,    4.5216,    5.0252,    3.5543,    2.7697,    3.7320,    4.1324,    2.2318,   -0.1402,   -0.5894,   -0.1007,   -1.2734,   -3.8303,   -4.9845,   -4.0491,   -3.5194,   -4.8045,   -5.8142,   -4.4738,   -2.2373,   -1.6720,   -2.1865,   -1.1072,    1.7181,    3.5605,    3.3077,    3.2360,    5.0731,    6.9995,    6.6522,    5.0664,    4.9083,    5.9802,    5.5830,    3.1212,    1.1795,    1.2500,    1.3143,   -0.6462,   -3.1390,   -3.5794,   -2.5628,   -2.7879,   -4.4520,   -4.8887,   -3.0622,   -1.3350,   -1.5262,   -1.9073,   -0.2014,    2.4797,    3.4081,    2.7364,    3.1393,    5.2089,    6.3787,    5.1955,    3.7351,    4.0884,    4.8471,    3.5170,    0.7857,   -0.5589,   -0.2390,   -0.8527,   -3.3843,   -5.4387,   -5.1855,   -4.3632,   -5.2799,   -6.8743,   -6.4849,   -4.3442,   -3.2144,   -3.7788,   -3.5604,   -1.1888,    1.1887,    1.4248,    0.8900,    2.0610,    4.2542,    4.7073,    3.1874,    2.3557,    3.2730,    3.6307,    1.6899,   -0.7197,   -1.2035,   -0.7464,   -1.9474,   -4.5293,   -5.7050,   -4.7875,   -4.2720,   -5.5675,   -6.5839,   -5.2462,   -3.0086,   -2.4384,   -2.9442,   -1.8523,    0.9892,    2.8515,    2.6222,    2.5773,    4.4446,    6.4043,    6.0932,    4.5465,    4.4300,    5.5460,    5.1950,    2.7813,    0.8895,    1.0113,    1.1280,   -0.7790,   -3.2177,   -3.6037,   -2.5324,   -2.7031,   -4.3132,   -4.6966,   -2.8177,   -1.0394,   -1.1808,   -1.5140,    0.2378,    2.9627,    3.9325,    3.2996,    3.7384,    5.8409,    7.0406,    5.8839,    4.4465,    4.8193,    5.5938,    4.2758,    1.5529,    0.2127,    0.5333,   -0.0836,   -2.6222,   -4.6875,   -4.4489,   -3.6450,   -4.5835,   -6.2032,   -5.8426,   -3.7338,   -2.6389,   -3.2411,   -3.0633,   -0.7347,    1.5975,    1.7863,    1.2024,    2.3227,    4.4639,    4.8639,    3.2903,    2.4042,    3.2669,    3.5701,    1.5750,   -0.8882,   -1.4248,   -1.0195,   -2.2709,   -4.9015,   -6.1240,   -5.2514,   -4.7783,   -6.1138,   -7.1674,   -5.8640,   -3.6576,   -3.1154,   -3.6458,   -2.5750,    0.2491,    2.0976,    1.8582,    1.8072,    3.6721,    5.6332,    5.3275,    3.7900,    3.6864,    4.8191,    4.4884,    2.0986,    0.2340,    0.3863,    0.5367,   -1.3338,   -3.7332,   -4.0772,   -2.9616,   -3.0859,   -4.6476,   -4.9810,   -3.0506,   -1.2197,   -1.3077,   -1.5867,    0.2196,    2.9991,    4.0233,    3.4443,    3.9364,    6.0911,    7.3418,    6.2346,    4.8450,    5.2635,    6.0816,    4.8047,    2.1202,    0.8157,    1.1689,    0.5814,   -1.9311,   -3.9737,   -3.7161,   -2.8967,   -3.8235,   -5.4353,   -5.0706,   -2.9616,   -1.8704,   -2.4801,   -2.3136,   -0.0000,    2.3136,    2.4801,    1.8704,    2.9616,    5.0706,    5.4353,    3.8235,    2.8967,    3.7161,    3.9737,    1.9311,   -0.5814,   -1.1689,   -0.8157,   -2.1202,   -4.8047,   -6.0816,   -5.2635,   -4.8450,   -6.2346,   -7.3418,   -6.0911,   -3.9364,   -3.4443,   -4.0233,   -2.9991,   -0.2196,    1.5867,    1.3077,    1.2197,    3.0506,    4.9810,    4.6476,    3.0859,    2.9616,    4.0772,    3.7332,    1.3338,   -0.5367,   -0.3863,   -0.2340,   -2.0986,   -4.4884,   -4.8191,   -3.6864,   -3.7900,   -5.3275,   -5.6332,   -3.6721,   -1.8072,   -1.8582,   -2.0976,   -0.2491,    2.5750,    3.6458,    3.1154,    3.6576,    5.8640,    7.1674,    6.1138,    4.7783,    5.2514,    6.1240,    4.9015,    2.2709,    1.0195,    1.4248,    0.8882,   -1.5750,   -3.5701,   -3.2669,   -2.4042,   -3.2903,   -4.8639,   -4.4639,   -2.3227,   -1.2024,   -1.7863,   -1.5975,    0.7347,    3.0633,    3.2411,    2.6389,    3.7338,    5.8426,    6.2032,    4.5835,    3.6450,    4.4489,    4.6875,    2.6222,    0.0836,   -0.5333,   -0.2127,   -1.5529,   -4.2758,   -5.5938,   -4.8193,   -4.4465,   -5.8839,   -7.0406,   -5.8409,   -3.7384,   -3.2996,   -3.9325,   -2.9627,   -0.2378,    1.5140,    1.1808,    1.0394,    2.8177,    4.6966,    4.3132,    2.7031,    2.5324,    3.6037,    3.2177,    0.7790,   -1.1280,   -1.0113,   -0.8895,   -2.7813,   -5.1950,   -5.5460,   -4.4300,   -4.5465,   -6.0932,   -6.4043,   -4.4446,   -2.5773,   -2.6222,   -2.8515,   -0.9892,    1.8523,    2.9442,    2.4384,    3.0086,    5.2462,    6.5839,    5.5675,    4.2720,    4.7875,    5.7050,    4.5293,    1.9474,    0.7464,    1.2035,    0.7197,   -1.6899,   -3.6307,   -3.2730,   -2.3557,   -3.1874,   -4.7073,   -4.2542,   -2.0610,   -0.8900,   -1.4248,   -1.1887,    1.1888,    3.5604,    3.7788,    3.2144,    4.3442,    6.4849,    6.8743,    5.2799,    4.3632,    5.1855,    5.4387,    3.3843,    0.8527,    0.2390,    0.5589,   -0.7857,   -3.5170,   -4.8471,   -4.0884,   -3.7351,   -5.1955,   -6.3787,   -5.2089,   -3.1393,   -2.7364,   -3.4081,   -2.4797,    0.2014,    1.9073,    1.5262,    1.3350,    3.0622,    4.8887,    4.4520,    2.7879,    2.5628,    3.5794,    3.1390,    0.6462,   -1.3143,   -1.2500,   -1.1795,   -3.1212,   -5.5830,   -5.9802,   -4.9083,   -5.0664,   -6.6522,   -6.9995,   -5.0731,   -3.2360,   -3.3077,   -3.5605,   -1.7181,    1.1072,    2.1865,    1.6720,    2.2373,    4.4738,    5.8142,    4.8045,    3.5194,    4.0491,    4.9845,    3.8303,    1.2734,    0.1007,    0.5894,    0.1402,   -2.2318,   -4.1324,   -3.7320,   -2.7697,   -3.5543,   -5.0252,   -4.5216,   -2.2765,   -1.0526,   -1.5337,   -1.2433,    1.1888,    3.6150,    3.8876,    3.3770,    4.5597,    6.7523,    7.1922,    5.6468,    4.7772,    5.6445,    5.9404,    3.9262,    1.4322,    0.8531,    1.2046,   -0.1116,   -2.8180,   -4.1266,   -3.3500,   -2.9825,   -4.4325,   -5.6091,   -4.4364,   -2.3679,   -1.9700,   -2.6504,   -1.7346};
// noisy sine wave
//const float input[] = {0.0280,   -0.0307,    0.1197,    0.2511,    0.3358,    0.5398,    0.5946,    0.6388,    0.6535,    0.8272,    0.9687,    0.8274,    1.0385,    0.8775,    1.0094,    1.1708,    0.7362,    0.9757,    1.0585,    0.9402,    0.7602,    0.8919,    0.7620,    0.6884,    0.8311,    0.4830,    0.4187,    0.4098,    0.3937,    0.0633,    0.1477,    0.0639,   -0.1106,    0.0091,   -0.1868,   -0.3773,   -0.3802,   -0.5723,   -0.7293,   -0.6540,   -0.7147,   -0.8733,   -0.7624,   -1.0083,   -0.7240,   -0.9865,   -0.9343,   -1.0713,   -0.9436,   -0.9211,   -0.7361,   -1.0061,   -0.8338,   -0.7950,   -0.7518,   -0.7895,   -0.6978,   -0.5214,   -0.4932,   -0.3617,   -0.2306,   -0.2294,    0.0035,    0.0324,    0.1760,    0.1837,    0.4263,    0.3518,    0.4152,    0.7722,    0.7077,    0.8219,    0.6766,    0.8628,    0.9091,    0.8905,    0.9159,    1.0152,    0.9751,    1.0733,    0.7530,    0.9846,    1.1180,    0.8084,    0.8763,    0.8840,    0.7042,    0.5803,    0.6879,    0.3722,    0.3884,    0.2776,    0.2987,    0.1185,   -0.0149,   -0.0547,   -0.1174,   -0.1169,   -0.4681,   -0.4861,   -0.3934,   -0.5803,   -0.6099,   -0.7879,   -0.8025,   -0.8885,   -1.0561,   -1.0727,   -1.1374,   -1.0684,   -0.9858,   -1.0000,   -1.0198,   -1.0623,   -0.9578,   -1.1135,   -1.0195,   -0.7186,   -0.7150,   -0.5601,   -0.3531,   -0.5262,   -0.3586,   -0.0759,   -0.1303,   -0.1179,   -0.0237,    0.1209,    0.1945,    0.4057,    0.3055,    0.5803,    0.6795,    0.6963,    0.9000,    0.7056,    0.9043,    1.0471,    0.9189,    1.1117,    0.8956,    1.0258,    0.9755,    1.0558,    1.0346,    1.0462,    1.0053,    0.6364,    0.6745,    0.6180,    0.5966,    0.5972,    0.4700,    0.4207,    0.5304,    0.1801,    0.0233,   -0.0282,    0.0002,   -0.1869,   -0.0125,   -0.3402,   -0.5030,   -0.5758,   -0.7480,   -0.8354,   -0.7885,   -1.0369,   -0.8480,   -1.0749,   -1.2351,   -1.0084,   -1.0765,   -1.0916,   -1.0399,   -1.0057,   -0.9807,   -0.9099,   -0.8793,   -0.8292,   -0.8038,   -0.7136,   -0.5041,   -0.5594,   -0.3904,   -0.2856,   -0.2047,   -0.0685,   -0.0780,    0.0313,    0.0337,    0.3332,    0.3372,    0.4261,    0.5695,    0.6374,    0.6547,    1.0305,    0.8455,    0.7964,    1.0269,    0.7275,    0.8385,    0.9041,    1.0723,    1.0576,    0.9459,    0.9734,    0.7194,    1.0380,    0.8776,    0.7460,    0.7094,    0.6535,    0.7029,    0.4914,    0.5269,    0.2251,    0.2852,   -0.0037,    0.2183,   -0.2870,   -0.1089,   -0.2001,   -0.2850,   -0.5609,   -0.6018,   -0.6589,   -0.8394,   -0.8179,   -0.8437,   -0.9146,   -0.7690,   -1.0343,   -0.9676,   -0.9778,   -0.8706,   -1.2171,   -1.0119,   -0.8337,   -1.0496,   -0.9050,   -0.6244,   -0.5624,   -0.6610,   -0.5882,   -0.4485,   -0.4260,   -0.3624,   -0.2183,   -0.1970,   -0.1395,    0.0559,    0.0065,    0.3635,    0.4702,    0.4607,    0.5318,    0.6761,    0.8134,    0.8856,    0.8990,    0.8535,    0.9513,    1.0533,    1.0054,    0.7742,    0.9529,    1.0244,    0.9560,    1.1437,    0.9238,    0.8436,    0.7708,    0.9173,    0.5530,    0.7939,    0.4553,    0.5346,    0.4819,    0.3773,    0.2412,    0.0677,    0.0979,   -0.0883,   -0.0835,   -0.3535,   -0.3007,   -0.3995,   -0.7205,   -0.6389,   -0.7117,   -0.7031,   -0.8622,   -0.8356,   -0.9920,   -0.8565,   -0.8827,   -0.7916,   -0.9655,   -1.2040,   -0.8461,   -0.9815,   -0.9607,   -0.6897,   -0.6219,   -0.5402,   -0.7297,   -0.5419,   -0.6159,   -0.3980,   -0.2310,   -0.4013,   -0.0477,    0.0067,    0.0966,    0.2902,    0.2256,    0.3525,    0.5287,    0.3816,    0.6423,    0.7346,    0.7786,    1.0472,    0.8214,    0.8271,    0.9340,    0.9424,    0.9918,    1.0256,    1.0615,    0.7962,    1.0449,    0.8979,    0.7732,    0.6555,    0.6766,    0.6211,    0.5433,    0.5241,    0.2835,    0.3906,    0.3783,    0.0586,    0.2506,   -0.1232,   -0.3455,   -0.2309,   -0.3557,   -0.5684,   -0.7557,   -0.7397,   -0.6697,   -0.7235,   -0.6990,   -0.8578,   -0.8979,   -0.9961,   -0.9030,   -1.0102,   -0.9219,   -0.9713,   -0.9769,   -1.0408,   -0.8392,   -0.7469,   -0.9951,   -0.8562,   -0.7827,   -0.6760,   -0.3661,   -0.4756,   -0.3702,   -0.2449,   -0.1844,    0.0826,   -0.0503,    0.1296,    0.0767,    0.3441,    0.3323,    0.5293,    0.5941,    0.5130,    0.8867,    0.8778,    0.9821,    0.7888,    0.8559,    0.9397,    0.9777,    0.8631,    0.9547,    0.9510,    1.1087,    0.9302,    0.8418,    0.6954,    0.6760,    0.5870,    0.6149,    0.6668,    0.3845,    0.6108,    0.2971,    0.1439,    0.1409,    0.0296,   -0.2207,   -0.0228,   -0.1706,   -0.4064,   -0.4317,   -0.4732,   -0.5123,   -0.7639,   -0.7602,   -0.6669,   -0.9073,   -0.8944,   -0.9697,   -0.9917,   -1.1210,   -0.9326,   -0.9617,   -0.8327,   -1.0938,   -1.0142,   -0.9253,   -0.6974,   -0.7253,   -0.8395,   -0.4714,   -0.6775,   -0.5110,   -0.3375,   -0.4275,   -0.1405,   -0.0268,    0.2441,    0.0642,    0.1973,    0.4075,    0.4305,    0.5800,    0.5910,    0.7943,    0.8580,    0.7993,    0.8478,    0.8858,    0.9949,    1.0392,    1.0711,    1.1248,    0.9828,    1.2611,    0.9876,    0.8934,    0.7316,    0.8597,    0.5542,    0.7529,    0.5372,    0.5742,    0.5260,    0.5212,    0.4167,    0.3125,    0.2735,    0.0714,   -0.0579,   -0.1245,   -0.3356,   -0.4005,   -0.3543,   -0.5439,   -0.7129,   -0.6874,   -0.8163,   -0.7889,   -0.8566,   -0.9622,   -1.0867,   -1.1171,   -0.9500,   -1.0158,   -0.9022,   -1.1492,   -0.9712,   -1.0530,   -0.9969,   -0.9427,   -0.8308,   -0.6040,   -0.6659,   -0.5806,   -0.3609,   -0.3752,   -0.2319,   -0.2696,    0.0423,    0.1200,    0.0323,    0.1628,    0.3970,    0.5251,    0.4760,    0.6172,    0.6052,    0.8379,    0.8114,    0.9243,    0.8967,    0.8941,    1.0563,    1.0487,    0.9977,    1.0859,    1.0562,    1.0961,    0.9765,    0.8122,    0.8785,    0.8254,    0.6999,    0.5994,    0.6570,    0.5478,    0.2893,    0.4062,    0.2140,    0.1767,   -0.1153,   -0.1902,   -0.0857,   -0.2637,   -0.2547,   -0.4040,   -0.6480,   -0.6000,   -0.5658,   -0.8107,   -0.7461,   -0.8539,   -0.8948,   -0.7669,   -1.1846,   -1.0998,   -1.0922,   -0.9939,   -1.0463,   -0.9957,   -0.8690,   -0.9942,   -0.9214,   -0.7676,   -0.7105,   -0.4071,   -0.4801,   -0.3847,   -0.3271,   -0.5015,   -0.2534,   -0.1901,   -0.0637,    0.2233,    0.2596,    0.3777,    0.3086,    0.5761,    0.6392,    0.6946,    0.8660,    0.7412,    0.8425,    0.8082,    1.0172,    1.0983,    0.9492,    1.0201,    1.0313,    0.8543,    1.1008,    0.7415,    0.9610,    0.8675,    0.9158,    0.6542,    0.6179,    0.5516,    0.4548,    0.3430,    0.1424,    0.1760,    0.0654,    0.0391,   -0.1197,   -0.3410,   -0.3844,   -0.4068,   -0.4417,   -0.7206,   -0.5801,   -0.8211,   -0.8033,   -0.9958,   -1.1126,   -0.9219,   -0.8672,   -0.8614,   -1.2122,   -1.0079,   -0.9081,   -1.0683,   -0.8391,   -1.0729,   -0.9294,   -0.9017,   -0.7950,   -0.6670,   -0.6169,   -0.6138,   -0.3293,   -0.3481,   -0.1362,   -0.1655,   -0.0885,    0.0904,    0.0683,    0.2332,    0.3326,    0.4466,    0.5456,    0.5416,    0.8503,    0.7808,    0.8611,    0.6734,    1.1507,    1.0019,    0.9614,    0.8424,    0.9056,    0.9498,    0.9203,    0.8612,    0.9792,    0.6280,    0.7500,    0.7601,    0.5488,    0.7377,    0.5338,    0.4957,    0.2786,    0.1075,    0.2651,    0.1704,   -0.1497,   -0.0148,   -0.2522,   -0.1663,   -0.2542,   -0.4594,   -0.6262,   -0.6000,   -0.6391,   -0.8065,   -0.7127,   -1.0697,   -0.8977,   -1.0291,   -0.9948,   -0.9368,   -0.8773,   -1.0619,   -0.9214,   -0.9717,   -0.8936,   -0.9983,   -0.7174,   -0.7780,   -0.5827,   -0.6411,   -0.5304,   -0.4144,   -0.1435,   -0.2913,   -0.1924,    0.0425,   -0.1183,    0.2266,    0.1467,    0.3815,    0.5810,    0.5072,    0.6845,    0.6630,    0.6130,    0.6974,    0.7918,    0.7533,    0.7589,    1.0251,    1.1128,    0.9255,    1.0497,    0.8115,    1.0867,    1.0060,    0.9108,    0.8688,    0.8412,    0.5713,    0.4729,    0.4862,    0.3871,    0.3827,    0.2418,    0.0483,    0.0024,   -0.0035,    0.0153,   -0.2035,   -0.3362,   -0.4100,   -0.7418,   -0.6535,   -0.6762,   -0.7494,   -0.6080,   -1.0015,   -0.8511,   -0.9298,   -1.1643,   -0.9129,   -0.9301,   -1.1158,   -0.9503,   -0.8041,   -0.9723,   -0.8067,   -0.7403,   -0.9361,   -0.7488,   -0.5450,   -0.3818,   -0.6334,   -0.4030,   -0.2678,   -0.2629,    0.0296,    0.0168,    0.2438,    0.1333,    0.3879,    0.3657,    0.4268,    0.5862,    0.6344,    0.7457,    0.7164,    0.8216,    1.0464,    0.7912,    1.0639,    1.0158,    1.2162,    1.1984,    0.9032,    1.1516,    0.9007,    0.8383,    0.7360,    0.7442,    0.6841,    0.6777,    0.6078,    0.5298,    0.3614,    0.3748,    0.1207,    0.3210,    0.0552,   -0.1044,   -0.1375,   -0.2732,   -0.3774,   -0.2893,   -0.2950,   -0.5848,   -0.6401,   -0.6954,   -1.0975,   -0.8137,   -0.8173,   -0.9054,   -0.9197,   -0.9800,   -0.9452,   -1.0389,   -1.0485,   -1.0252,   -1.0500,   -0.7713,   -0.8531,   -0.7396,   -0.7653,   -0.5267,   -0.6033,   -0.5357,   -0.2840,   -0.3296,   -0.2973,    0.1722,   -0.0648,    0.2079,    0.1197,    0.3885,    0.4374,    0.4099,    0.2803,    0.8586,    0.7736,    0.7101,    0.7283,    0.8809,    0.7900,    0.7656,    0.9396,    0.9770,    0.9377,    0.9576,    0.8397,    0.7373,    0.9415,    0.7887,    0.9250,    0.9397,    0.6530,    0.5685,    0.5736,    0.4880,    0.2659,    0.0337,    0.2015,   -0.1655,    0.1157,   -0.1855,   -0.1787,   -0.3763,   -0.5173,   -0.5238,   -0.5988,   -0.8275,   -0.7124,   -0.8750,   -0.9462,   -0.8583,   -0.9604,   -1.3039,   -1.1459,   -0.8373,   -0.8766,   -0.9800,   -0.8145,   -1.0178,   -0.9772,   -0.9088,   -0.6754,   -0.7154,   -0.6919,   -0.6387,   -0.6461,   -0.4860,   -0.2533,   -0.2259,   -0.1626,    0.1067,    0.2781,    0.1560,    0.3574,    0.4083,    0.5399,    0.7048,    0.7593,    0.8444,    0.8527,    0.9811,    0.8609,    1.1562,    0.8031,    1.0770,    1.1760,    0.9236,    0.8076,    1.1166,    0.9267,    0.7700,    0.8026,    0.9204,    0.6933,    0.6618,    0.5717,    0.5514,    0.4157,    0.3723,    0.4565,    0.1335,    0.0535,    0.1289,   -0.1645,   -0.3881,   -0.5743,   -0.3915,   -0.6502,   -0.7439,   -0.8248,   -0.7520,   -0.8154,   -0.9015,   -0.8677,   -1.0659,   -0.9866,   -1.0150,   -1.0129,   -1.1787,   -0.9305,   -0.5990,   -1.0702,   -0.8755,   -1.0248,   -0.6850,   -0.6883,   -0.4427,   -0.4343,   -0.5361,   -0.3617,   -0.2774,   -0.2283,    0.1359,   -0.0470,    0.1124,    0.3378,    0.4161,    0.4264,    0.6646,    0.6955,    0.6122,    0.6868,    0.8206,    0.9634,    0.8511,    0.8843,    1.0168,    0.9541,    1.0077,    0.9228,    0.9230,    0.9441,    0.8342,    1.0186,    0.9641,    0.7718,    0.6249,    0.6948,    0.5395,    0.4006,    0.3581,    0.3757,    0.1238,    0.1564,    0.1039,   -0.1545,   -0.3573,   -0.2714,   -0.2569,   -0.3945,   -0.7871,   -0.5477,   -0.8591,   -0.7447,   -0.9429,   -1.0375,   -0.9448,   -1.0788,   -1.2414,   -1.1895,   -1.1005,   -0.9297,   -0.8180,   -0.7702,   -0.8721,   -1.0135,   -0.9116,   -0.6283,   -0.7036,   -0.4778,   -0.6508};
// sine wave 5 Hz
const float input2[] = {0,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,    0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,    0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,    0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,   -0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,   -0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,    0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,   -0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,    0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822,    0.3923,    1.5451,    2.6125,    3.5355,    4.2632,    4.7553,    4.9846,    4.9384,    4.6194,    4.0451,    3.2472,    2.2700,    1.1672,    0.0000,   -1.1672,   -2.2700,   -3.2472,   -4.0451,   -4.6194,   -4.9384,   -4.9846,   -4.7553,   -4.2632,   -3.5355,   -2.6125,   -1.5451,   -0.3923,    0.7822,    1.9134,    2.9389,    3.8020,    4.4550,    4.8618,    5.0000,    4.8618,    4.4550,    3.8020,    2.9389,    1.9134,    0.7822,   -0.3923,   -1.5451,   -2.6125,   -3.5355,   -4.2632,   -4.7553,   -4.9846,   -4.9384,   -4.6194,   -4.0451,   -3.2472,   -2.2700,   -1.1672,   -0.0000,    1.1672,    2.2700,    3.2472,    4.0451,    4.6194,    4.9384,    4.9846,    4.7553,    4.2632,    3.5355,    2.6125,    1.5451,    0.3923,   -0.7822,   -1.9134,   -2.9389,   -3.8020,   -4.4550,   -4.8618,   -5.0000,   -4.8618,   -4.4550,   -3.8020,   -2.9389,   -1.9134,   -0.7822};

int i, j, k;
double tmp;
double out[] = {0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0};
double real[] = {0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0};
double imag[] = {0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0};
  


const float fs = 133.333333; //sampling frequency in Hertz (Hz)

void setup()
{
  Serial.begin(115200); 
  while(!Serial); //will not run until Serial Monitor or Plotter is open
  //Serial.println(millis());
  KickFilters<float>::bandpass(input, filtered, tmpArr, samples, 4,6, fs); // BANDPASS HERE. Parameters: (input, output, temp (just required, no purpose afterwards), sample #, highpass, lowpass, Samp. Freq.)
    
  for (k = 0; k < samples; k++)  //  position in output
  {
    tmp = 0;

    for (i = 0; i < coefLen; i++)  //  position in coefficients array
    {
      j = k - i;  //  position in input

      if (j >= 0)  //  bounds check for input buffer
      {
        tmp += coef[i] * filtered[j-6];
      }
    }

    out[k] = tmp;
  }
  for(int p = 0; p < samples; p++){
    if(p < samples - ((coefLen-1)/2)) {
      real[p] = filtered[p];
    }
    if(p > ((coefLen-1)/2)-1){
      imag[p] = out[p];
    }
  }

    for(int a = 0; a < samples; a++) {
      // Calculates four-quadrant arctan. This is the equivalent of the angle() function in MATLAB.
      double phase = atan2(imag[a], real[a]);
      Serial.print(phase); 
      Serial.print(","); 
      Serial.println(filtered[a]); 
  }
  //Serial.println(millis());
}

void loop()
{
}
